import csv

names = {}
scientists = {}
papers = {}

def get_data():
    with open ("scientists.csv", encoding = "utf-8") as scientists_file:
        reader = csv.DictReader(scientists_file)
        for row in reader:
            scientist_id = row["id"]
            name = row["name"].strip().lower()
            scientists[scientist_id] = {"name" : row["name"], "papers" : set()}

            if name not in names: 
                names [name] = {scientist_id}
            else:
                names[name].add(scientist_id)

    with open ("papers.csv", encoding = "utf-8") as papers_file:
        reader = csv.DictReader(papers_file)
        for row in reader:
            paper_id = row["id"]
            papers[paper_id] = {"title": row["title"], "year": row["year"], "authors": set()}

    with open("authors.csv", encoding="utf-8") as authors_files:
        reader = csv.DictReader(authors_files)
        for row in reader:
            scientist_id = row["scientist_id"]
            paper_id = row["paper_id"]
            if scientist_id in scientists:
                scientists[scientist_id]["papers"].add(paper_id)
            if paper_id in papers:
                papers[paper_id]["authors"].add(scientist_id)

    print ("Loaded successfully.")
